<div class="resume-container">

    <!-- LEFT SIDE FORM -->
    <div class="resume-form-panel">
        <h2>Resume Builder</h2>

        <form [formGroup]="resumeForm">

            <div class="section">
                <h3>Basic Info</h3>
                <input formControlName="name" placeholder="Full Name">
                <input formControlName="title" placeholder="Job Title">
                <textarea formControlName="summary" placeholder="Summary"></textarea>
            </div>

            <div class="section">
                <h3>Contact Info</h3>
                <input formControlName="email" placeholder="Email">
                <input formControlName="phone" placeholder="Phone">
                <input formControlName="location" placeholder="Location">
                <input formControlName="linkedin" placeholder="LinkedIn">
            </div>
            <div class="section">
                <h3>Experience</h3>
                <button class="add-btn" type="button" (click)="addExperience()">+ Add Experience</button>
                <div *ngFor="let exp of experience.controls; let i = index" [formGroup]="exp" class="exp-preview">
                    <input formControlName="role" placeholder="Role">
                    <input formControlName="company" placeholder="Company">
                    <input formControlName="duration" placeholder="Duration">
                    <div *ngFor="let p of getPoints(exp).controls; let j = index">
                        <input [formControl]="p" placeholder="Point {{ j + 1 }}">
                        <button type="button" class="remove-btn" (click)="removePoint(i, j)">-</button>
                    </div>
                    <button type="button" class="add-btn" (click)="addPoint(i)">+ Add Point</button>
                    <button type="button" class="remove-btn" (click)="removeExperience(i)">ðŸ—‘Experience Remove</button>
                </div>
            </div>

            <div class="section">
                <h3>Projects</h3>
                <button class="add-btn" type="button" (click)="addProject()">+ Add Project</button>
                <div *ngFor="let p of projects.controls; let i = index" [formGroup]="p" class="dynamic-card">
                    <input formControlName="name" placeholder="Project Name">
                    <input formControlName="link" placeholder="Project Link">
                    <textarea formControlName="desc" placeholder="Description"></textarea>
                    <button class="remove-btn" type="button" (click)="removeProject(i)">Remove</button>
                </div>
            </div>

            <div class="section">
                <h2>Education</h2>
                <button type="button" class="add-btn" (click)="addEducation()">+ Add Education</button>
                <div *ngFor="let edu of education.controls; let i = index" [formGroup]="edu">
                    <ng-container *ngIf="edu instanceof FormGroup">
                        <input formControlName="course" placeholder="Course">
                        <input formControlName="university" placeholder="University">
                        <input formControlName="year" placeholder="Year">
                        <input formControlName="score" placeholder="CGPA or %" title="Enter CGPA or Percentage">
                        <button type="button" class="remove-btn" (click)="removeEducation(i)">Remove</button>
                    </ng-container>
                </div>
            </div>

            <div class="section">
                <h3>Certificates</h3>
                <button type="button" class="add-btn" (click)="addCertificate()">+ Add Certificate</button>
                <div *ngFor="let cert of certificates.controls; let i = index" [formGroup]="cert">
                    <input formControlName="name" placeholder="Certificate Name">
                    <input formControlName="issuedBy" placeholder="Issued By">
                    <input formControlName="year" placeholder="Year">
                    <button type="button" class="remove-btn" (click)="removeCertificate(i)">Remove</button>

                </div>
            </div>

            <div class="section">
                <h3>Skills</h3>

                <button class="add-btn" type="button" (click)="addSkillCategory()">
                    + Add Skill Category
                </button>

                <div *ngFor="let sk of skills.controls; let i = index" [formGroup]="sk" class="dynamic-card">

                    <input formControlName="title" placeholder="Category Title (e.g., Frontend)" />

                    <div *ngFor="let item of getSkillItems(sk).controls; let j = index">
                        <input [formControl]="item" placeholder="Skill {{ j + 1 }}" />

                        <button type="button" class="remove-btn" (click)="removeSkillItem(i, j)">Remove</button>
                    </div>

                    <button type="button" class="add-btn" (click)="addSkillItem(i)">+ Add Skill Item</button>

                    <button type="button" class="remove-btn" (click)="removeSkillCategory(i)">
                        Remove Category
                    </button>

                </div>
            </div>


            <div class="submit-section">
                <button class="download-btn" type="button" (click)="generatePDF()">Download PDF</button>
            </div>

        </form>
    </div>

    <!-- RIGHT SIDE PREVIEW -->
    <div class="resume-preview-panel">
        <div #resumeContent>
            <div class="resume-preview-content" style="margin: 25px 20px 0 12px;">

                <h1 class="h-title">{{ resumeForm.value.name }}</h1>
                <div class="sub-title">{{ resumeForm.value.title }}</div>

                <p class="mar-t9 fs-12">{{ resumeForm.value.summary }}</p>
            </div>

            <div class="contact-bar">

                <div class="contact-item">
                    <span class="contact-icon">
                        <svg width="16" height="16" fill="white" viewBox="0 0 16 16">
                            <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v.217l-8 4.8-8-4.8V4z" />
                            <path
                                d="M0 6.383v5.617a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6.383l-7.555 4.533a1 1 0 0 1-.89 0L0 6.383z" />
                        </svg>
                    </span>
                    {{ resumeForm.value.email }}
                </div>

                <div class="contact-item">
                    <span class="contact-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="white"
                            stroke-width="2" viewBox="0 0 24 24">
                            <path
                                d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.79 19.79 0 0 1 2.12 4.18 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.12.91.37 1.79.72 2.63a2 2 0 0 1-.45 2.11L8 9.91a16 16 0 0 0 6 6l1.45-1.38a2 2 0 0 1 2.11-.45c.84.35 1.72.6 2.63.72A2 2 0 0 1 22 16.92z" />
                        </svg>
                    </span>
                    {{ resumeForm.value.phone }}
                </div>

                <div class="contact-item">
                    <span class="contact-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="white"
                            stroke-width="2" viewBox="0 0 24 24">
                            <path d="M21 10c0 6-9 12-9 12S3 16 3 10a9 9 0 1 1 18 0z" />
                            <circle cx="12" cy="10" r="3" />
                        </svg>
                    </span>
                    {{ resumeForm.value.location }}
                </div>

                <div class="contact-item">
                    <span class="contact-icon pointer" (click)="openLinkedIn()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="white" class="linked-css">
                            <path
                                d="M4.98 3.5C4.98 4.88 3.88 6 2.5 6S0 4.88 0 3.5 1.12 1 2.5 1 4.98 2.12 4.98 3.5zM.22 23.75h4.55V7.98H.22V23.75zM8.48 7.98v15.77h4.55v-8.77c0-2.33.43-4.58 3.32-4.58 2.86 0 2.9 2.67 2.9 4.73v8.62h4.55V14.2c0-5.66-1.22-10.03-7.83-10.03-3.18 0-5.31 1.74-6.18 3.39h.05V7.98H8.48z" />
                        </svg>
                    </span>
                    <a *ngIf="resumeForm.value.linkedin" [href]="formatLinkedIn(resumeForm.value.linkedin)"
                        class="linkedin-link" target="_blank">
                        {{ resumeForm.value.linkedin }}
                    </a>
                </div>

            </div>

            <div class="row resume-preview-content" style="margin: 0 20px 0 12px;">
                <!-- LEFT -->
                <div class="left">
                    <h2 class="mb-10">WORK EXPERIENCE</h2>
                    <div *ngFor="let exp of experience.controls; let i = index" class="exp-preview mb-25">
                        <b>{{ exp.value.role }}</b><br>
                        <span class="fs13">
                            {{ exp.value.company }}
                            ({{ exp.value.duration }})
                        </span>
                        <ul class="points-list">
                            <li *ngFor="let p of getPoints(exp).controls">{{ p.value }}</li>
                        </ul>
                    </div>

                    <h2 class="mb-10">EDUCATION</h2>
                    <div *ngFor="let edu of resumeForm.value.education">
                        <b>{{ edu.course }}</b><br>
                        <span>
                            {{ edu.university }} â€“ {{ edu.year }} | {{edu.score ? ( edu.score) : '' }}
                        </span>
                    </div>
                </div>



                <!-- RIGHT -->
                <div class="right">
                    <h2 class="mb-10">SKILLS</h2>
                    <div *ngFor="let sk of skills.controls" class="card">
                        {{ sk.value.title ? sk.value.title + ':' : ''}}
                        {{ getSkillLine(sk) }}
                    </div>

                    <div class="project-section-wrapper">
                        <h2 class="mb-10">PROJECTS</h2>
                        <div *ngFor="let p of resumeForm.value.projects" class="project-item">
                            <b>{{ p.name }}</b><br>
                            <a *ngIf="p.link" class="project-link" [href]="p.link" target="_blank">{{ p.link }}</a>
                            <ul style="margin-bottom: 25px;margin-top: 3px;">
                                <li>
                                    <p>{{ p.desc }}</p>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div>

                        <h2 class="mb-10">CERTIFICATIONS</h2>

                        <div *ngFor="let cert of resumeForm.value.certificates" class="mb-10">
                            <b>{{ cert.name }}</b><br>
                            {{ cert.issuedBy }} â€“ {{ cert.year }}
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>